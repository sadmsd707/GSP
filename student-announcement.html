<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Announcements - Student Dashboard</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background: #f5f7fa;
      color: #333;
      line-height: 1.6;
      overflow-x: hidden;
    }

    header {
      background: #2563eb;
      color: white;
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      position: relative;
      z-index: 100;
    }

    header h1 {
      font-size: 1.8rem;
      font-weight: 700;
    }

    .student-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    /* Hamburger Menu Styles */
    .hamburger {
      background: none;
      border: none;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      width: 30px;
      height: 21px;
      padding: 0;
    }

    .hamburger span {
      display: block;
      height: 3px;
      width: 100%;
      background-color: white;
      border-radius: 3px;
      transition: all 0.3s ease;
    }

    /* Side Navigation Panel */
    .side-nav {
      position: fixed;
      top: 0;
      right: -300px;
      width: 300px;
      height: 100vh;
      background: linear-gradient(to bottom, #2563eb, #1e3a8a);
      box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
      transition: right 0.4s ease;
      z-index: 1000;
      padding-top: 70px;
    }

    .side-nav.active {
      right: 0;
    }

    .side-nav ul {
      list-style: none;
      padding: 0;
    }

    .side-nav ul li {
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .side-nav ul li a {
      display: block;
      color: white;
      text-decoration: none;
      padding: 15px 30px;
      font-size: 1.1rem;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .side-nav ul li a:hover {
      background-color: rgba(255, 255, 255, 0.1);
      padding-left: 40px;
    }

    .nav-icon {
      font-size: 1.2rem;
      width: 20px;
      text-align: center;
    }

    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .overlay.active {
      opacity: 1;
      visibility: visible;
    }

    /* Dashboard Styles */
    .dashboard {
      padding: 30px 20px;
      max-width: 1200px;
      margin: auto;
    }

    .welcome-section {
      background: linear-gradient(to right, #2563eb, #1e3a8a);
      color: white;
      padding: 30px;
      border-radius: 15px;
      margin-bottom: 30px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
    }

    .welcome-section::before {
      content: "";
      position: absolute;
      top: -50%;
      right: -50%;
      width: 100%;
      height: 200%;
      background: rgba(255, 255, 255, 0.1);
      transform: rotate(30deg);
    }

    .welcome-section h2 {
      font-size: 2.2rem;
      margin-bottom: 10px;
      position: relative;
    }

    .welcome-section p {
      font-size: 1.2rem;
      opacity: 0.9;
      position: relative;
    }

    .dashboard-section {
      background: white;
      border-radius: 15px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.05);
    }

    .dashboard-section h3 {
      color: #1e3a8a;
      margin-bottom: 25px;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* Announcement Cards */
    .announcements-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 25px;
      margin-bottom: 30px;
    }

    .announcement-card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.08);
      border-top: 4px solid #2563eb;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .announcement-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    }

    .announcement-card.important {
      border-top-color: #ef4444;
    }

    .announcement-card.exam {
      border-top-color: #f59e0b;
    }

    .announcement-card.resource {
      border-top-color: #10b981;
    }

    .announcement-card.general {
      border-top-color: #8b5cf6;
    }

    .announcement-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
    }

    .badge-important {
      background: #fee2e2;
      color: #dc2626;
    }

    .badge-exam {
      background: #fef3c7;
      color: #d97706;
    }

    .badge-resource {
      background: #d1fae5;
      color: #065f46;
    }

    .badge-general {
      background: #ede9fe;
      color: #6d28d9;
    }

    .announcement-header {
      margin-bottom: 15px;
      padding-right: 80px;
    }

    .announcement-header h4 {
      color: #1e3a8a;
      font-size: 1.3rem;
      margin-bottom: 5px;
    }

    .announcement-category {
      color: #2563eb;
      font-weight: 600;
      font-size: 0.9rem;
    }

    .announcement-content {
      margin-bottom: 20px;
      color: #4b5563;
      line-height: 1.7;
    }

    .announcement-content p {
      margin-bottom: 10px;
    }

    .announcement-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 20px;
      padding-top: 15px;
      border-top: 1px solid #e5e7eb;
      font-size: 0.9rem;
      color: #6b7280;
    }

    .announcement-author {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .author-avatar {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: #2563eb;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: bold;
    }

    /* Filter Section */
    .filter-section {
      background: #f8fafc;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 25px;
      display: flex;
      gap: 15px;
      align-items: center;
      flex-wrap: wrap;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .filter-label {
      font-size: 0.9rem;
      color: #374151;
      font-weight: 600;
    }

    .filter-select {
      padding: 10px 15px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      background: white;
      font-size: 0.9rem;
      min-width: 150px;
      cursor: pointer;
    }

    .filter-select:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    /* Search functionality */
    .search-container {
      position: relative;
      margin-bottom: 20px;
    }
    
    .search-input {
      width: 100%;
      padding: 12px 45px 12px 15px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s ease;
    }
    
    .search-input:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }
    
    .search-icon {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #6b7280;
    }

    /* Notification badge */
    .notification-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background: #ef4444;
      color: white;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      font-size: 0.7rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #64748b;
    }

    .empty-icon {
      font-size: 4rem;
      margin-bottom: 20px;
      opacity: 0.5;
    }

    .empty-state h4 {
      color: #475569;
      margin-bottom: 10px;
    }

    /* Statistics */
    .stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .stat-card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      text-align: center;
      border-top: 4px solid #2563eb;
    }
    
    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: #2563eb;
      margin-bottom: 5px;
    }
    
    .stat-label {
      font-size: 0.9rem;
      color: #6b7280;
    }

    /* Refresh button */
    .refresh-btn {
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px 15px;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
    }
    
    .refresh-btn:hover {
      background: #2563eb;
      transform: translateY(-2px);
    }

    /* Loading overlay */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.8);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 2001;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .loading-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 5px solid #e5e7eb;
      border-top: 5px solid #2563eb;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 15px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    footer {
      background: #1e3a8a;
      color: white;
      text-align: center;
      padding: 30px;
      margin-top: 50px;
    }

    footer p {
      font-size: 1rem;
    }

    /* Responsive styles */
    @media (max-width: 768px) {
      header {
        padding: 15px 20px;
      }
      
      .welcome-section h2 {
        font-size: 1.8rem;
      }
      
      .welcome-section p {
        font-size: 1rem;
      }
      
      .announcements-container {
        grid-template-columns: 1fr;
      }
      
      .filter-section {
        flex-direction: column;
        align-items: stretch;
      }
      
      .announcement-meta {
        flex-direction: column;
        gap: 10px;
        align-items: flex-start;
      }
      
      .stats-container {
        grid-template-columns: 1fr 1fr;
      }
    }
    
    @media (max-width: 480px) {
      .stats-container {
        grid-template-columns: 1fr;
      }
      
      .announcement-header {
        padding-right: 0;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Soham - Student Dashboard</h1>
    <div class="student-info">
      <div class="notification-badge" id="notificationBadge" style="display: none;">3</div>
    </div>
    <button class="hamburger" id="hamburger">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </header>

  <!-- Side Navigation -->
  <div class="side-nav" id="sideNav">
    <ul>
      <li><a href="student-dashboard.html">Home</a></li>
      <li><a href="take-test.html">Take a Test</a></li>
      <li><a href="exam.html">Practice</a></li>
      <li><a href="scores.html">Scores</a></li>
      <li><a href="announcements.html">Announcements</a></li>
      <li><a href="student-resources.html">Resources</a></li>
      <li><a href="board-prep.html">Board Preparation</a></li>
      <li><a href="student-account.html">My Account</a></li>
      <li><a href="role-selection.html" onclick="logout()">Logout</a></li>
    </ul>
  </div>

  <!-- Overlay for closing the menu when clicking outside -->
  <div class="overlay" id="overlay"></div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner"></div>
    <p>Loading announcements...</p>
  </div>

  <main class="dashboard">
    <section class="welcome-section">
      <h2>Announcements</h2>
      <p>Stay updated with important notices from teachers and administrators</p>
    </section>

    <!-- Announcement Statistics -->
    <div class="stats-container">
      <div class="stat-card">
        <div class="stat-value" id="totalAnnouncements">0</div>
        <div class="stat-label">Total Announcements</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="importantCount">0</div>
        <div class="stat-label">Important</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="unreadCount">0</div>
        <div class="stat-label">Unread</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="todayCount">0</div>
        <div class="stat-label">Today</div>
      </div>
    </div>

    <div class="dashboard-section">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h3><span class="icon">üì¢</span> Latest Announcements</h3>
        <button class="refresh-btn" onclick="fetchAnnouncements()">
          <span>üîÑ</span> Refresh
        </button>
      </div>
      
      <!-- Search and Filters -->
      <div class="search-container">
        <input type="text" class="search-input" id="searchInput" placeholder="Search announcements by title, content, or author..." onkeyup="searchAnnouncements()">
        <span class="search-icon">üîç</span>
      </div>
      
      <!-- Filter Section -->
      <div class="filter-section">
        <div class="filter-group">
          <label class="filter-label">Filter by Category</label>
          <select class="filter-select" id="categoryFilter" onchange="filterAnnouncements()">
            <option value="all">All Categories</option>
            <option value="important">Important</option>
            <option value="exam">Exam Related</option>
            <option value="resource">Study Resources</option>
            <option value="general">General</option>
          </select>
        </div>
        <div class="filter-group">
          <label class="filter-label">Filter by Status</label>
          <select class="filter-select" id="statusFilter" onchange="filterAnnouncements()">
            <option value="all">All</option>
            <option value="unread">Unread</option>
            <option value="read">Read</option>
          </select>
        </div>
        <div class="filter-group">
          <label class="filter-label">Sort by</label>
          <select class="filter-select" id="sortFilter" onchange="filterAnnouncements()">
            <option value="newest">Newest First</option>
            <option value="oldest">Oldest First</option>
            <option value="important">Most Important</option>
          </select>
        </div>
      </div>

      <!-- Announcements Container -->
      <div class="announcements-container" id="announcementsContainer">
        <!-- Announcement cards will be populated by JavaScript -->
      </div>

      <div class="empty-state" id="emptyState" style="display: none;">
        <div class="empty-icon">üì¢</div>
        <h4>No announcements available</h4>
        <p>You don't have any announcements yet. Check back later for updates.</p>
      </div>
    </div>
  </main>

  <footer>
    <p>&copy; 2026 Soham - Entrance Exam Practice. All rights reserved.</p>
    <p style="margin-top: 10px; font-size: 0.9rem;">Made with ‚ù§Ô∏è by Team Soham</p>
  </footer>

  <script>
    // Check if user is logged in and is a student
    if (localStorage.getItem("isLoggedIn") !== "true" || localStorage.getItem("userRole") !== "student") {
      window.location.href = "role-selection.html";
    }

    // Load student data
    function loadStudentData() {
      const studentName = localStorage.getItem('userName') || 'Student';
      const studentId = localStorage.getItem('userId') || '';
      
      document.getElementById('studentName').textContent = studentName;
      
      // Create avatar from name initials
      const initials = studentName.split(' ').map(n => n[0]).join('').toUpperCase();
      document.getElementById('studentAvatar').textContent = initials;
    }

    // Sample announcements data
    const announcementsData = [
      {
        id: 1,
        title: "MHT-CET 2026 Syllabus Update",
        category: "important",
        author: "Dr. Sharma",
        authorInitials: "DS",
        content: "Important changes have been made to the MHT-CET 2026 syllabus. Please review the updated syllabus document available in the Resources section. Key changes include additional topics in Physics Chapter 12 and Mathematics Chapter 7.",
        date: new Date().toISOString(),
        read: false,
        important: true
      },
      {
        id: 2,
        title: "Upcoming Mock Test Schedule",
        category: "exam",
        author: "Ms. Patel",
        authorInitials: "MP",
        content: "The monthly mock test series for MHT-CET preparation will begin next Monday. Schedule:\n‚Ä¢ Physics: Monday, 10 AM\n‚Ä¢ Chemistry: Tuesday, 10 AM\n‚Ä¢ Mathematics: Wednesday, 10 AM\n\nAll tests will be available in the Practice section.",
        date: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString(),
        read: true,
        important: false
      },
      {
        id: 3,
        title: "New Study Materials Added",
        category: "resource",
        author: "Mr. Kumar",
        authorInitials: "MK",
        content: "New study materials for Physics and Chemistry have been added to the Resources section. This includes:\n‚Ä¢ Complete revision notes for all chapters\n‚Ä¢ Previous year question papers with solutions\n‚Ä¢ Topic-wise practice questions\n‚Ä¢ Video explanations for difficult concepts",
        date: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(),
        read: false,
        important: false
      },
      {
        id: 4,
        title: "Parent-Teacher Meeting Schedule",
        category: "general",
        author: "Admin",
        authorInitials: "AD",
        content: "The next parent-teacher meeting is scheduled for next Saturday. Parents can book slots through the portal. Please inform your parents to check their registered email for the invitation link.",
        date: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString(),
        read: true,
        important: false
      },
      {
        id: 5,
        title: "Important: Test Pattern Change",
        category: "important",
        author: "Dr. Gupta",
        authorInitials: "DG",
        content: "Please note that the test pattern for MHT-CET 2026 has been updated. The number of questions has been increased from 150 to 200, with additional weightage given to Mathematics. Updated sample papers are available in the Resources section.",
        date: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000).toISOString(),
        read: false,
        important: true
      },
      {
        id: 6,
        title: "Weekly Progress Report",
        category: "general",
        author: "System",
        authorInitials: "SY",
        content: "Your weekly progress report is now available. You can view your performance analytics, weak areas, and improvement suggestions in the Scores section. Keep up the good work!",
        date: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),
        read: true,
        important: false
      },
      {
        id: 7,
        title: "Special Workshop on Problem Solving",
        category: "resource",
        author: "Mr. Verma",
        authorInitials: "MV",
        content: "A special workshop on advanced problem-solving techniques for Physics and Mathematics will be conducted this Friday at 3 PM. The session will cover shortcut methods, time management, and common pitfalls to avoid.",
        date: new Date(Date.now() - 6 * 24 * 60 * 60 * 1000).toISOString(),
        read: false,
        important: false
      },
      {
        id: 8,
        title: "Holiday Schedule Update",
        category: "general",
        author: "Admin",
        authorInitials: "AD",
        content: "The institute will remain closed on the upcoming national holiday. Online classes and tests will continue as per schedule. Make sure to complete your assignments before the deadline.",
        date: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(),
        read: true,
        important: false
      }
    ];

    let allAnnouncements = [];
    let filteredAnnouncements = [];

    // Format date for display
    function formatDate(dateString) {
      const date = new Date(dateString);
      const now = new Date();
      const diffTime = Math.abs(now - date);
      const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
      
      if (diffDays === 0) {
        return 'Today';
      } else if (diffDays === 1) {
        return 'Yesterday';
      } else if (diffDays < 7) {
        return `${diffDays} days ago`;
      } else {
        return date.toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'short',
          day: 'numeric'
        });
      }
    }

    // Format time for display
    function formatTime(dateString) {
      const date = new Date(dateString);
      return date.toLocaleTimeString('en-US', {
        hour: '2-digit',
        minute: '2-digit'
      });
    }

    // Get badge class based on category
    function getBadgeClass(category) {
      switch(category) {
        case 'important': return 'badge-important';
        case 'exam': return 'badge-exam';
        case 'resource': return 'badge-resource';
        case 'general': return 'badge-general';
        default: return 'badge-general';
      }
    }

    // Get card class based on category
    function getCardClass(category) {
      switch(category) {
        case 'important': return 'announcement-card important';
        case 'exam': return 'announcement-card exam';
        case 'resource': return 'announcement-card resource';
        case 'general': return 'announcement-card general';
        default: return 'announcement-card general';
      }
    }

    // Get category display name
    function getCategoryName(category) {
      switch(category) {
        case 'important': return 'Important Notice';
        case 'exam': return 'Exam Related';
        case 'resource': return 'Study Resource';
        case 'general': return 'General';
        default: return 'General';
      }
    }

    // Load announcements from localStorage or use sample data
    function loadAnnouncements() {
      const savedAnnouncements = localStorage.getItem('studentAnnouncements');
      
      if (savedAnnouncements) {
        allAnnouncements = JSON.parse(savedAnnouncements);
      } else {
        allAnnouncements = announcementsData;
        localStorage.setItem('studentAnnouncements', JSON.stringify(allAnnouncements));
      }
      
      // Get read status from localStorage
      const readStatus = JSON.parse(localStorage.getItem('announcementReadStatus')) || {};
      
      // Update read status
      allAnnouncements.forEach(announcement => {
        announcement.read = readStatus[announcement.id] || false;
      });
      
      filteredAnnouncements = [...allAnnouncements];
      displayAnnouncements();
      updateAnnouncementStatistics();
    }

    // Mark announcement as read
    function markAsRead(announcementId) {
      const readStatus = JSON.parse(localStorage.getItem('announcementReadStatus')) || {};
      readStatus[announcementId] = true;
      localStorage.setItem('announcementReadStatus', JSON.stringify(readStatus));
      
      // Update in memory
      const announcement = allAnnouncements.find(a => a.id === announcementId);
      if (announcement) {
        announcement.read = true;
      }
      
      // Update display
      displayAnnouncements();
      updateAnnouncementStatistics();
    }

    // Display announcements
    function displayAnnouncements() {
      const container = document.getElementById('announcementsContainer');
      const emptyState = document.getElementById('emptyState');
      
      if (filteredAnnouncements.length === 0) {
        container.innerHTML = '';
        emptyState.style.display = 'block';
        return;
      }
      
      emptyState.style.display = 'none';
      
      let html = '';
      filteredAnnouncements.forEach(announcement => {
        const badgeClass = getBadgeClass(announcement.category);
        const cardClass = getCardClass(announcement.category);
        const categoryName = getCategoryName(announcement.category);
        const formattedDate = formatDate(announcement.date);
        const formattedTime = formatTime(announcement.date);
        
        // Format content with line breaks
        const formattedContent = announcement.content.replace(/\n/g, '<br>');
        
        html += `
          <div class="${cardClass}" onclick="markAsRead(${announcement.id})" style="cursor: pointer;">
            <div class="announcement-badge ${badgeClass}">${categoryName}</div>
            ${!announcement.read ? '<div style="position: absolute; top: 15px; left: 15px; width: 10px; height: 10px; background: #ef4444; border-radius: 50%;"></div>' : ''}
            
            <div class="announcement-header">
              <h4>${announcement.title}</h4>
              <div class="announcement-category">From: ${announcement.author}</div>
            </div>
            
            <div class="announcement-content">
              ${formattedContent}
            </div>
            
            <div class="announcement-meta">
              <div class="announcement-author">
                <div class="author-avatar">${announcement.authorInitials}</div>
                <span>${announcement.author}</span>
              </div>
              <div>
                <span>${formattedDate} at ${formattedTime}</span>
                ${!announcement.read ? '<span style="margin-left: 10px; color: #ef4444; font-weight: 600;">NEW</span>' : ''}
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    // Update announcement statistics
    function updateAnnouncementStatistics() {
      const totalAnnouncements = allAnnouncements.length;
      const importantCount = allAnnouncements.filter(a => a.category === 'important').length;
      const unreadCount = allAnnouncements.filter(a => !a.read).length;
      
      // Count announcements from today
      const today = new Date();
      const todayCount = allAnnouncements.filter(a => {
        const announcementDate = new Date(a.date);
        return announcementDate.toDateString() === today.toDateString();
      }).length;
      
      document.getElementById('totalAnnouncements').textContent = totalAnnouncements;
      document.getElementById('importantCount').textContent = importantCount;
      document.getElementById('unreadCount').textContent = unreadCount;
      document.getElementById('todayCount').textContent = todayCount;
      
      // Update notification badge
      const notificationBadge = document.getElementById('notificationBadge');
      if (unreadCount > 0) {
        notificationBadge.textContent = unreadCount > 9 ? '9+' : unreadCount;
        notificationBadge.style.display = 'flex';
      } else {
        notificationBadge.style.display = 'none';
      }
    }

    // Search announcements
    function searchAnnouncements() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      
      let filtered = [...allAnnouncements];
      
      // Apply search filter
      if (searchTerm) {
        filtered = filtered.filter(announcement => 
          announcement.title.toLowerCase().includes(searchTerm) ||
          announcement.content.toLowerCase().includes(searchTerm) ||
          announcement.author.toLowerCase().includes(searchTerm)
        );
      }
      
      // Apply other filters
      filtered = applyFilters(filtered);
      
      filteredAnnouncements = filtered;
      displayAnnouncements();
    }

    // Apply filters to announcements
    function applyFilters(announcements) {
      const categoryFilter = document.getElementById('categoryFilter').value;
      const statusFilter = document.getElementById('statusFilter').value;
      const sortFilter = document.getElementById('sortFilter').value;
      
      let filtered = [...announcements];
      
      // Apply category filter
      if (categoryFilter !== 'all') {
        filtered = filtered.filter(announcement => announcement.category === categoryFilter);
      }
      
      // Apply status filter
      if (statusFilter === 'unread') {
        filtered = filtered.filter(announcement => !announcement.read);
      } else if (statusFilter === 'read') {
        filtered = filtered.filter(announcement => announcement.read);
      }
      
      // Apply sorting
      filtered.sort((a, b) => {
        if (sortFilter === 'newest') {
          return new Date(b.date) - new Date(a.date);
        } else if (sortFilter === 'oldest') {
          return new Date(a.date) - new Date(b.date);
        } else if (sortFilter === 'important') {
          // Sort by importance (important first, then by date)
          if (a.important && !b.important) return -1;
          if (!a.important && b.important) return 1;
          return new Date(b.date) - new Date(a.date);
        }
        return 0;
      });
      
      return filtered;
    }

    // Filter announcements
    function filterAnnouncements() {
      const filtered = applyFilters(allAnnouncements);
      filteredAnnouncements = filtered;
      displayAnnouncements();
    }

    // Fetch announcements (simulate loading from server)
    function fetchAnnouncements() {
      // Show loading overlay
      document.getElementById('loadingOverlay').classList.add('active');
      
      // Simulate API call delay
      setTimeout(() => {
        // In a real application, this would fetch from an API
        // For now, we'll just reload from localStorage
        loadAnnouncements();
        
        // Hide loading overlay
        document.getElementById('loadingOverlay').classList.remove('active');
        
        // Show success message
        showSuccessMessage('Announcements refreshed successfully!');
      }, 1000);
    }

    // Show success message
    function showSuccessMessage(message) {
      // Create a simple notification
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: #2563eb;
        color: white;
        padding: 15px 25px;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        z-index: 1000;
        display: flex;
        align-items: center;
        gap: 10px;
      `;
      notification.innerHTML = `<span>‚úÖ</span><span>${message}</span>`;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        document.body.removeChild(notification);
      }, 3000);
    }

    // Logout function
    function logout() {
      const logoutBtn = event.target;
      const originalText = logoutBtn.innerHTML;
      logoutBtn.innerHTML = '<span class="loading"></span> Logging out...';
      logoutBtn.disabled = true;
      
      setTimeout(() => {
        localStorage.removeItem("isLoggedIn");
        localStorage.removeItem("userRole");
        localStorage.removeItem("userId");
        localStorage.removeItem("userName");
        window.location.href = "login.html";
      }, 1000);
    }

    // Hamburger menu functionality
    const hamburger = document.getElementById('hamburger');
    const sideNav = document.getElementById('sideNav');
    const overlay = document.getElementById('overlay');

    hamburger.addEventListener('click', () => {
      sideNav.classList.toggle('active');
      overlay.classList.toggle('active');
      document.body.style.overflow = sideNav.classList.contains('active') ? 'hidden' : 'auto';
    });

    overlay.addEventListener('click', () => {
      sideNav.classList.remove('active');
      overlay.classList.remove('active');
      document.body.style.overflow = 'auto';
    });

    // Close menu when clicking on a link
    const navLinks = document.querySelectorAll('.side-nav a');
    navLinks.forEach(link => {
      link.addEventListener('click', () => {
        sideNav.classList.remove('active');
        overlay.classList.remove('active');
        document.body.style.overflow = 'auto';
      });
    });

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      loadStudentData();
      loadAnnouncements();
    });
  </script>
</body>
</html>
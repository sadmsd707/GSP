<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MHT-CET Quiz</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #e0f2fe;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    .quiz-container {
      max-width: 700px;
      margin: auto;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      padding: 20px 25px;
      position: relative;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      font-size: 14px;
      color: #1e3a8a;
    }
    .header-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .header-right {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .question-number {
      font-weight: bold;
      color: #2563eb;
    }
    .question {
      font-size: 16px;
      margin: 20px 0;
    }
    .options input[type="radio"] {
      display: none;
    }
    .options label {
      display: block;
      background: #eff6ff;
      margin: 8px 0;
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s;
      border-left: 4px solid transparent;
    }
    .options input[type="radio"]:checked + label {
      background: #dbeafe;
      border-left: 4px solid #2563eb;
      font-weight: 500;
    }
    .nav-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }
    .btn {
      padding: 10px 20px;
      background: #2563eb;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
    }
    .btn:hover {
      background: #1e40af;
    }
    .btn.right {
      margin-left: auto;
    }
    
    /* Timer Styling */
    .timer {
      display: flex;
      align-items: center;
      gap: 5px;
      background: #eff6ff;
      padding: 5px 10px;
      border-radius: 4px;
      font-weight: 500;
    }
    
    /* Question Navigation Panel */
    .nav-panel-toggle {
      cursor: pointer;
      font-size: 20px;
      z-index: 10;
      background: #eff6ff;
      padding: 5px 10px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .nav-panel {
      display: none;
      position: absolute;
      top: 50px;
      right: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      padding: 15px;
      z-index: 10;
      width: 250px;
      max-height: 300px;
      overflow-y: auto;
    }
    .nav-panel h3 {
      margin: 0 0 10px 0;
      font-size: 16px;
      color: #2563eb;
      border-bottom: 1px solid #eee;
      padding-bottom: 5px;
    }
    .question-list {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
    }
    .question-item {
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s;
    }
    .question-item.answered {
      background: #3b82f6;
      color: white;
    }
    .question-item.seen {
      background: #f87171;
      color: white;
    }
    .question-item.not-seen {
      background: #d1d5db;
      color: #6b7280;
    }
    .question-item.current {
      border: 2px solid #2563eb;
      box-sizing: border-box;
    }
    .question-item:hover {
      transform: scale(1.1);
    }
    
    /* Save notification */
    .save-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #3b82f6;
      color: white;
      padding: 12px 20px;
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 1000;
      display: none;
      align-items: center;
      gap: 10px;
    }
  </style>
</head>
<body>
  <div class="quiz-container">
    <div class="header">
      <div class="header-left">
        <div>MHT CET 2025 · Communication Systems</div>
      </div>
      <div class="header-right">
        <div class="timer">Time: <span id="timer">00:00</span></div>
        <div class="nav-panel-toggle" onclick="toggleNavPanel()">☰</div>
      </div>
    </div>
    
    <div class="nav-panel" id="navPanel">
      <h3>Questions</h3>
      <div class="question-list" id="questionList"></div>
    </div>

    <div id="quiz-content"></div>
    
    <div class="nav-buttons">
      <button class="btn" id="backBtn" onclick="prevQuestion()" style="display:none;">Back</button>
      <button class="btn right" id="nextBtn" onclick="nextQuestion()">Next</button>
      <button class="btn right" id="submitBtn" onclick="submitQuiz()" style="display:none;">Submit</button>
    </div>
  </div>

  <!-- Save notification -->
  <div class="save-notification" id="saveNotification">
    <span>Results saved successfully!</span>
    <button onclick="hideNotification()" style="background: none; border: none; color: white; cursor: pointer; font-size: 16px;">×</button>
  </div>

  <script>
    const questions = [
      {
        number: "Question 01",
        text: "Identify the 'INCORRECT' statement from the following.",
        options: [
          "Modulated signal is to be followed by power amplifier and then fed to an antenna.",
          "The receiving antenna is followed by amplifier, intermediate frequency (IF) stage and detector.",
          "Modulation index μ is kept greater than one to avoid distortion.",
          "AM detection is carried out using a rectifier and an envelop detector."
        ],
        correct: "C"
      },
      {
        number: "Question 02",
        text: "Modulation is a process of superposing",
        options: [
          "high frequency audio signal on low frequency radio wave",
          "low frequency audio signal on high frequency radio wave",
          "high frequency radio wave on low frequency audio signal",
          "low frequency radio wave on high frequency audio signal"
        ],
        correct: "B"
      },
      {
        number: "Question 03",
        text: "A carrier wave of peak voltage 16 volt is used to transmit a signal. If the modulation index is 75%, the peak voltage of the modulating signal is",
        options: ["8 V", "10 V", "12 V", "14 V"],
        correct: "C"
      },
      {
        number: "Question 04",
        text: "In the process of space communication, use of modem is necessary. In which one of the following modes modem acts as a modulator and a demodulator respectively?",
        options: [
          "Transmitting and receiving.",
          "Receiving and transmitting.",
          "Both transmitting.",
          "Both receiving."
        ],
        correct: "A"
      },
      {
        number: "Question 05",
        text: "In communication system, a repeater is used to extend the range of transmission. It is the combination of",
        options: [
          "transmitter and receiver",
          "amplifier and transmitter",
          "amplifier and receiver",
          "receiver and transmitter"
        ],
        correct: "D"
      },
      {
        number: "Question 06",
        text: "In amplitude modulation,",
        options: [
          "amplitude remains constant but frequency changes according to information signal.",
          "amplitude of carrier wave changes according to information signal.",
          "both amplitude and frequency do not change according to information signal.",
          "both amplitude and frequency change according to information signal."
        ],
        correct: "B"
      },
      {
        number: "Question 07",
        text: "In communication system, the range for line of sight propagation in case of earth is 'd', for the height of antenna (h). If 'h' is doubled then the new range is",
        options: ["√2 d", "2d", "d√2", "d/√2"],
        correct: "A"
      },
      {
        number: "Question 08",
        text: "In communication system, for a given block diagram of receiver, the boxes 'X' and 'Y' respectively represent",
        options: [
          "IF stage and amplifier",
          "IF stage and detector",
          "Amplifier and IF stage",
          "Detector and amplifier"
        ],
        correct: "B"
      },
      {
        number: "Question 09",
        text: "According to theoretical study of radiation from a same linear antenna, the power radiated is proportional to [λ = wavelength]",
        options: ["λ²", "λ⁻²", "λ", "λ⁴"],
        correct: "B"
      },
      {
        number: "Question 10",
        text: "The digital signals are used for transmission in communication system. They are",
        options: [
          "only of discrete stepwise values.",
          "sound and picture signals in television.",
          "fundamental sine waves.",
          "continuous variations of current or voltage."
        ],
        correct: "A"
      },
      {
        number: "Question 11",
        text: "A signal of frequency 3 kHz is amplitude modulated on a carrier wave of frequency 2.5 MHz. The upper and lower sideband frequencies in the resultant signal are",
        options: [
          "2503 kHz and 2497 kHz",
          "2005 kHz and 1995 kHz",
          "2500 kHz and 2494 kHz",
          "2497 kHz and 2503 kHz"
        ],
        correct: "A"
      },
      {
        number: "Question 12",
        text: "In communication system, what is used to extend the range of a communication?",
        options: ["Transducer", "Amplifier", "Repeater", "Antenna"],
        correct: "C"
      },
      {
        number: "Question 13",
        text: "A layer of atmosphere that reflects medium frequency radio waves which is ineffective during night, is",
        options: ["F-layer", "E-layer", "D-layer", "Troposphere"],
        correct: "C"
      },
      {
        number: "Question 14",
        text: "In frequency modulated wave",
        options: [
          "amplitude changes according to message signal",
          "frequency changes according to message signal",
          "both amplitude and frequency change",
          "amplitude remains constant"
        ],
        correct: "B"
      },
      {
        number: "Question 15",
        text: "In amplitude modulation, the amplitude of carrier wave is A_c and that of the modulating signal is A_m. In practice, the ratio of A_m to A_c is kept less than or equal to one, to avoid",
        options: ["noise", "distortion", "over modulation", "carrier suppression"],
        correct: "C"
      },
      {
        number: "Question 16",
        text: "In amplitude modulation",
        options: [
          "carrier frequency is varied",
          "carrier amplitude is varied",
          "three sidebands are produced",
          "fidelity is improved"
        ],
        correct: "B"
      },
      {
        number: "Question 17",
        text: "In communication system the process of superimposing a low frequency signal on a high frequency wave is known as",
        options: ["attenuation", "modulation", "transduction", "reproduction"],
        correct: "B"
      },
      {
        number: "Question 18",
        text: "The maximum frequency of transmitted radio waves above which the radio waves are no longer reflected back by ionosphere is ______ (N = maximum electron density of ionosphere, g = acceleration due to gravity)",
        options: ["√(N g)", "√(N/g)", "9√N", "√(9N)"],
        correct: "D"
      },
      {
        number: "Question 19",
        text: "Which of the following is the communication channel in case of radio communication?",
        options: ["Wire", "Cable", "Antenna", "Atmosphere"],
        correct: "D"
      },
      {
        number: "Question 20",
        text: "The waves which are reflected back to the earth by ionosphere is",
        options: [
          "ground waves",
          "sky waves",
          "space waves",
          "very high frequency waves"
        ],
        correct: "B"
      }
    ];

    let current = 0;
    const userAnswers = {};
    const seenQuestions = new Set();
    const startTime = new Date();
    let navPanelVisible = false;

    function renderQuestion(index) {
      const q = questions[index];
      const container = document.getElementById("quiz-content");
      container.innerHTML = `
        <div class="question-number">${q.number}</div>
        <div class="question">${q.text}</div>
        <div class="options">
          ${q.options.map((opt, i) => {
            const id = `q${index}_${String.fromCharCode(65 + i)}`;
            const checked = userAnswers[index] === String.fromCharCode(65 + i) ? "checked" : "";
            return `
              <input type="radio" id="${id}" name="mcq${index}" value="${String.fromCharCode(65 + i)}" ${checked}>
              <label for="${id}">${String.fromCharCode(65 + i)}) ${opt}</label>
            `;
          }).join("")}
        </div>
      `;

      seenQuestions.add(index);
      
      document.getElementById("backBtn").style.display = index === 0 ? "none" : "inline-block";
      document.getElementById("nextBtn").style.display = index === questions.length - 1 ? "none" : "inline-block";
      document.getElementById("submitBtn").style.display = index === questions.length - 1 ? "inline-block" : "none";
      
      updateNavPanel();
    }

    function updateNavPanel() {
      const questionList = document.getElementById("questionList");
      questionList.innerHTML = '';
      
      questions.forEach((q, index) => {
        const questionItem = document.createElement("div");
        questionItem.className = "question-item";
        questionItem.textContent = index + 1;
        
        if (userAnswers[index]) {
          questionItem.classList.add("answered");
        } else if (seenQuestions.has(index)) {
          questionItem.classList.add("seen");
        } else {
          questionItem.classList.add("not-seen");
        }
        
        if (index === current) {
          questionItem.classList.add("current");
        }
        
        questionItem.onclick = () => {
          saveAnswer();
          current = index;
          renderQuestion(current);
          toggleNavPanel();
        };
        
        questionList.appendChild(questionItem);
      });
    }

    function toggleNavPanel() {
      const navPanel = document.getElementById("navPanel");
      navPanelVisible = !navPanelVisible;
      navPanel.style.display = navPanelVisible ? "block" : "none";
    }

    function nextQuestion() {
      saveAnswer();
      if (current < questions.length - 1) {
        current++;
        renderQuestion(current);
      }
    }

    function prevQuestion() {
      saveAnswer();
      if (current > 0) {
        current--;
        renderQuestion(current);
      }
    }

    function saveAnswer() {
      const selected = document.querySelector(`input[name="mcq${current}"]:checked`);
      if (selected) {
        userAnswers[current] = selected.value;
      }
    }

    function submitQuiz() {
      saveAnswer();
      
      // Generate test name with timestamp
      const now = new Date();
      const testName = `MHT-CET Test ${now.toLocaleDateString()} ${now.toLocaleTimeString()}`;
      
      const endTime = new Date();
      const timeTakenMs = endTime - startTime;
      const timeTakenMin = Math.floor(timeTakenMs / 60000);
      const timeTakenSec = Math.floor((timeTakenMs % 60000) / 1000);

      let correct = 0;
      const results = [];

      questions.forEach((q, i) => {
        const userAns = userAnswers[i] || "Not Answered";
        const isCorrect = userAns === q.correct;
        if (isCorrect) correct++;
        results.push({
          number: q.number,
          userAns,
          correctAns: q.correct,
          isCorrect
        });
      });

      // Create result object
      const resultData = {
        testName: testName,
        total: questions.length,
        correct: correct,
        accuracy: (correct / questions.length * 100).toFixed(2),
        time: `${timeTakenMin} min ${timeTakenSec} sec`,
        timestamp: now.toISOString(),
        details: results
      };

      // Save to localStorage
      try {
        // Get existing scores or initialize empty array
        let scores = JSON.parse(localStorage.getItem("quizScores")) || [];
        
        // Add new score
        scores.push(resultData);
        
        // Save back to localStorage
        localStorage.setItem("quizScores", JSON.stringify(scores));
        
        // Also save the current result for the result page
        localStorage.setItem("quizResults", JSON.stringify(resultData));
        
        // Show save notification
        showNotification();
        
        // Redirect to results page after a short delay
        setTimeout(() => {
          window.location.href = "result.html";
        }, 1500);
      } catch (e) {
        console.error("Error saving results:", e);
        alert("Error saving results. Please try again.");
      }
    }

    function showNotification() {
      const notification = document.getElementById("saveNotification");
      notification.style.display = "flex";
    }

    function hideNotification() {
      const notification = document.getElementById("saveNotification");
      notification.style.display = "none";
    }

    // Initialize the quiz
    renderQuestion(current);

    // Stopwatch Timer
    let minutes = 0, seconds = 0;
    const timerEl = document.getElementById("timer");
    setInterval(() => {
      seconds++;
      if (seconds === 60) {
        seconds = 0;
        minutes++;
      }
      timerEl.textContent = `${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;
    }, 1000);
  </script>
</body>
</html>